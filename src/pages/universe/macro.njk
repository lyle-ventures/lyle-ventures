---
layout: layouts/universe.njk
title: Macro Cycle Dashboard
permalink: /universe/macro/
---

{#
  ============================================================================
  MACRO CYCLE DASHBOARD - Execution Display
  ============================================================================
  Data is pre-populated from FRED. Update via Claude Code sessions.

  Last Updated: January 24, 2026
  Data Source: FRED (Federal Reserve Economic Data)
  ============================================================================
#}

<div id="macro-app" class="min-h-screen">
  <!-- Header -->
  <div class="border-b border-indigo-500/20 bg-gray-900/50">
    <div class="max-w-6xl mx-auto px-4 py-4">
      <div class="flex flex-wrap items-center justify-between gap-4">
        <div>
          <a href="/universe/" class="text-xs text-indigo-400 hover:text-indigo-300 mb-1 inline-block">&larr; Dashboard</a>
          <h1 class="text-xl font-semibold text-gray-100">Macro Cycle Dashboard</h1>
          <p class="text-xs text-gray-500 mt-1">GMI/Bittel Framework | Data: <span id="data-date" class="text-green-400">Jan 24, 2026</span></p>
        </div>
        <div class="flex flex-wrap gap-4 sm:gap-6 text-center">
          <div>
            <p class="text-xs uppercase tracking-wider text-gray-500">Cycle Score</p>
            <p id="cycle-score" class="text-2xl font-bold text-green-400">--</p>
          </div>
          <div>
            <p class="text-xs uppercase tracking-wider text-gray-500">Season</p>
            <p id="cycle-season" class="text-lg font-semibold text-green-400">--</p>
          </div>
          <div>
            <p class="text-xs uppercase tracking-wider text-gray-500">Signal</p>
            <p id="main-signal" class="text-lg font-semibold text-green-400">--</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="max-w-6xl mx-auto px-4 py-6">

    <!-- Cycle Meter -->
    <div class="universe-card rounded-lg p-6 mb-6">
      <h2 class="text-sm font-bold uppercase tracking-widest text-gray-400 mb-4">Macro Cycle Position</h2>
      <div class="relative">
        <div class="h-8 rounded-full bg-gradient-to-r from-blue-600 via-green-500 via-yellow-500 to-red-500 relative overflow-hidden">
          <div id="cycle-needle" class="absolute top-0 bottom-0 w-1 bg-white shadow-lg transition-all duration-500" style="left: 50%">
            <div class="absolute -top-2 left-1/2 -translate-x-1/2 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-white"></div>
          </div>
        </div>
        <div class="flex justify-between mt-2 text-xs text-gray-400">
          <span>WINTER</span>
          <span>SPRING</span>
          <span>SUMMER</span>
          <span>FALL</span>
        </div>
      </div>
    </div>

    <!-- Probability Grid -->
    <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
      <div class="universe-card rounded-lg p-4 text-center">
        <p class="text-xs text-gray-500 uppercase mb-1">Bullish</p>
        <p id="prob-bullish" class="text-2xl font-bold text-green-400">--%</p>
      </div>
      <div class="universe-card rounded-lg p-4 text-center">
        <p class="text-xs text-gray-500 uppercase mb-1">Neutral</p>
        <p id="prob-neutral" class="text-2xl font-bold text-yellow-400">--%</p>
      </div>
      <div class="universe-card rounded-lg p-4 text-center">
        <p class="text-xs text-gray-500 uppercase mb-1">Caution</p>
        <p id="prob-caution" class="text-2xl font-bold text-orange-400">--%</p>
      </div>
      <div class="universe-card rounded-lg p-4 text-center">
        <p class="text-xs text-gray-500 uppercase mb-1">Bearish</p>
        <p id="prob-bearish" class="text-2xl font-bold text-red-400">--%</p>
      </div>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">

      <!-- Left Column: Data Cards -->
      <div class="lg:col-span-2 space-y-6">

        <!-- Key Metrics Grid -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <!-- Net Liquidity -->
          <div class="universe-card rounded-lg p-5">
            <div class="flex items-center justify-between mb-3">
              <h3 class="text-xs font-bold uppercase tracking-widest text-gray-400">US Net Liquidity</h3>
              <span id="liq-signal" class="text-xs px-2 py-0.5 rounded bg-green-500/20 text-green-400">--</span>
            </div>
            <p id="net-liquidity" class="text-2xl font-bold text-gray-100">$--</p>
            <p class="text-xs text-gray-500 mt-1">Fed Balance Sheet - TGA - RRP</p>
            <div class="mt-3 pt-3 border-t border-gray-700/50">
              <div class="flex justify-between text-xs">
                <span class="text-gray-500">YoY Change</span>
                <span id="liq-yoy" class="text-green-400">--%</span>
              </div>
            </div>
          </div>

          <!-- Financial Conditions -->
          <div class="universe-card rounded-lg p-5">
            <div class="flex items-center justify-between mb-3">
              <h3 class="text-xs font-bold uppercase tracking-widest text-gray-400">Financial Conditions</h3>
              <span id="fci-signal" class="text-xs px-2 py-0.5 rounded bg-green-500/20 text-green-400">--</span>
            </div>
            <p id="fci-score" class="text-2xl font-bold text-gray-100">--</p>
            <p class="text-xs text-gray-500 mt-1">Composite Index (0-100)</p>
            <div class="mt-3 pt-3 border-t border-gray-700/50 grid grid-cols-3 gap-2 text-xs">
              <div>
                <p class="text-gray-500">DXY</p>
                <p id="fci-dxy" class="text-gray-300">--</p>
              </div>
              <div>
                <p class="text-gray-500">HY Spread</p>
                <p id="fci-hy" class="text-gray-300">--%</p>
              </div>
              <div>
                <p class="text-gray-500">Curve</p>
                <p id="fci-curve" class="text-gray-300">--%</p>
              </div>
            </div>
          </div>

          <!-- Business Cycle -->
          <div class="universe-card rounded-lg p-5">
            <div class="flex items-center justify-between mb-3">
              <h3 class="text-xs font-bold uppercase tracking-widest text-gray-400">Business Cycle</h3>
              <span id="ism-signal" class="text-xs px-2 py-0.5 rounded bg-yellow-500/20 text-yellow-400">--</span>
            </div>
            <p id="ism-value" class="text-2xl font-bold text-gray-100">--</p>
            <p class="text-xs text-gray-500 mt-1">ISM Manufacturing PMI</p>
            <div class="mt-3 pt-3 border-t border-gray-700/50">
              <div class="flex justify-between text-xs">
                <span class="text-gray-500">3Mo Momentum</span>
                <span id="ism-momentum" class="text-gray-300">--</span>
              </div>
            </div>
          </div>

          <!-- BTC Analysis -->
          <div class="universe-card rounded-lg p-5">
            <div class="flex items-center justify-between mb-3">
              <h3 class="text-xs font-bold uppercase tracking-widest text-gray-400">BTC vs Fair Value</h3>
              <span id="btc-signal" class="text-xs px-2 py-0.5 rounded bg-green-500/20 text-green-400">--</span>
            </div>
            <p id="btc-discount" class="text-2xl font-bold text-green-400">--</p>
            <p class="text-xs text-gray-500 mt-1">Discount to liquidity-implied FV</p>
            <div class="mt-3 pt-3 border-t border-gray-700/50">
              <div class="flex justify-between text-xs">
                <span class="text-gray-500">Fair Value</span>
                <span id="btc-fair-value" class="text-gray-300">$--</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Full Scorecard -->
        <div class="universe-card rounded-lg p-6">
          <h2 class="text-sm font-bold uppercase tracking-widest text-gray-400 mb-4">Indicator Scorecard</h2>
          <div class="overflow-x-auto">
            <table class="w-full text-sm">
              <thead>
                <tr class="border-b border-gray-700">
                  <th class="text-left py-2 text-gray-500 font-medium">Indicator</th>
                  <th class="text-right py-2 text-gray-500 font-medium">Value</th>
                  <th class="text-right py-2 text-gray-500 font-medium">Signal</th>
                  <th class="text-right py-2 text-gray-500 font-medium">Weight</th>
                  <th class="text-right py-2 text-gray-500 font-medium">Score</th>
                </tr>
              </thead>
              <tbody id="scorecard-body">
                <tr><td colspan="5" class="py-4 text-center text-gray-500">Calculating...</td></tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- Right Column: Controls & Info -->
      <div class="space-y-6">

        <!-- BTC Price Input -->
        <div class="universe-card rounded-lg p-6">
          <h2 class="text-sm font-bold uppercase tracking-widest text-gray-400 mb-4">BTC Price</h2>
          <div class="space-y-3">
            <input type="number" id="btc-input" value="89500" class="w-full bg-gray-900/50 border border-indigo-500/30 rounded px-3 py-2 text-gray-100 text-lg font-mono focus:outline-none focus:border-indigo-500">
            <div class="grid grid-cols-2 gap-2">
              <button onclick="MacroApp.updateBtc()" class="py-2 bg-indigo-500 hover:bg-indigo-600 text-white rounded text-sm transition-colors">
                Update
              </button>
              <button onclick="MacroApp.fetchBtc()" class="py-2 bg-gray-700/50 hover:bg-gray-700 text-gray-300 rounded text-sm transition-colors">
                Fetch Live
              </button>
            </div>
          </div>
        </div>

        <!-- Interpretation Guide -->
        <div class="universe-card rounded-lg p-6">
          <h2 class="text-sm font-bold uppercase tracking-widest text-gray-400 mb-4">Interpretation</h2>
          <div class="space-y-3 text-xs text-gray-400">
            <div>
              <p class="text-green-400 font-semibold">SUMMER (75-100)</p>
              <p>Peak expansion. Risk assets favored.</p>
            </div>
            <div>
              <p class="text-yellow-400 font-semibold">SPRING (55-75)</p>
              <p>Recovery phase. Accumulate risk.</p>
            </div>
            <div>
              <p class="text-orange-400 font-semibold">FALL (35-55)</p>
              <p>Late cycle. Reduce risk.</p>
            </div>
            <div>
              <p class="text-blue-400 font-semibold">WINTER (0-35)</p>
              <p>Contraction. Defensive posture.</p>
            </div>
          </div>
        </div>

        <!-- Data Source -->
        <div class="universe-card rounded-lg p-6">
          <h2 class="text-sm font-bold uppercase tracking-widest text-gray-400 mb-4">Data Sources</h2>
          <div class="space-y-2 text-xs text-gray-500">
            <p>FRED: Fed Balance Sheet, TGA, RRP, ISM, Credit Spreads, Yield Curve, DXY</p>
            <p>BTC: CoinGecko (live) or manual</p>
            <p class="text-gray-600 mt-2">Macro data updated via Claude Code sessions. Bring fresh FRED data to update.</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
// ============================================================================
// CONFIGURATION
// ============================================================================
// Set your Cloudflare Worker URL here to enable live FRED data
// Deploy cloudflare-worker/fred-proxy.js to Cloudflare Workers first
// Cloudflare Worker proxies FRED API requests (avoids CORS + hides API key)
const FRED_PROXY_URL = 'https://fred-proxy.ethan-109.workers.dev';

// ============================================================================
// MACRO DATA (Fallback when no proxy configured)
// Last Updated: January 24, 2026
// ============================================================================
const MACRO_DATA = {
  // Fed Balance Sheet (WALCL) - Millions
  fedBalanceSheet: 6850000,  // $6.85T
  fedBalanceSheetYoY: 6750000, // Year ago

  // Treasury General Account (WTREGEN) - Millions
  tga: 750000,  // $750B

  // Reverse Repo (RRPONTSYD) - Billions
  rrp: 150,  // $150B (way down from peak)

  // ISM Manufacturing (NAPM)
  ism: 49.2,
  ism3moAgo: 47.8,

  // HY Credit Spread (BAMLH0A0HYM2) - Percent
  hySpread: 3.2,

  // 10Y-2Y Yield Curve (T10Y2Y) - Percent
  yieldCurve: 0.25,

  // Trade-Weighted Dollar (DTWEXBGS)
  dxy: 107.5,

  // Data timestamp
  asOf: 'January 24, 2026'
};

// ============================================================================
// MACRO APP
// ============================================================================
const MacroApp = {
  btcPrice: 89500,
  liveData: null,

  async init() {
    if (FRED_PROXY_URL) {
      await this.fetchLiveMacroData();
    }
    this.calculate();
  },

  async fetchLiveMacroData() {
    try {
      document.getElementById('data-date').textContent = 'Loading...';
      document.getElementById('data-date').className = 'text-yellow-400';

      // Fetch all series in parallel
      const series = [
        { id: 'WALCL', key: 'fedBalanceSheet' },
        { id: 'WTREGEN', key: 'tga' },
        { id: 'RRPONTSYD', key: 'rrp' },
        { id: 'NAPM', key: 'ism' },
        { id: 'BAMLH0A0HYM2', key: 'hySpread' },
        { id: 'T10Y2Y', key: 'yieldCurve' },
        { id: 'DTWEXBGS', key: 'dxy' }
      ];

      const results = await Promise.all(
        series.map(async s => {
          const res = await fetch(`${FRED_PROXY_URL}?series_id=${s.id}&limit=5`);
          const data = await res.json();
          return { ...s, data };
        })
      );

      // Process results
      this.liveData = {};
      let latestDate = null;

      results.forEach(r => {
        const obs = r.data.observations;
        if (obs && obs.length > 0) {
          const val = parseFloat(obs[0].value);
          if (!isNaN(val)) {
            this.liveData[r.key] = val;
            // Track latest date
            if (!latestDate || obs[0].date > latestDate) {
              latestDate = obs[0].date;
            }
          }
          // Get YoY for fed balance sheet
          if (r.key === 'fedBalanceSheet' && obs.length > 1) {
            const yoyVal = parseFloat(obs[obs.length - 1].value);
            if (!isNaN(yoyVal)) {
              this.liveData.fedBalanceSheetYoY = yoyVal;
            }
          }
          // Get 3mo ago ISM
          if (r.key === 'ism' && obs.length >= 4) {
            const ism3mo = parseFloat(obs[3].value);
            if (!isNaN(ism3mo)) {
              this.liveData.ism3moAgo = ism3mo;
            }
          }
        }
      });

      // Update MACRO_DATA with live values
      if (Object.keys(this.liveData).length > 0) {
        Object.assign(MACRO_DATA, this.liveData);
        if (latestDate) {
          const d = new Date(latestDate);
          MACRO_DATA.asOf = d.toLocaleDateString('en-US', { year: 'numeric', month: 'short', day: 'numeric' });
        }
        document.getElementById('data-date').textContent = MACRO_DATA.asOf + ' (Live)';
        document.getElementById('data-date').className = 'text-green-400';
      }
    } catch (e) {
      console.error('Failed to fetch live FRED data:', e);
      document.getElementById('data-date').textContent = MACRO_DATA.asOf + ' (Cached)';
      document.getElementById('data-date').className = 'text-yellow-400';
    }
  },

  updateBtc() {
    const price = parseFloat(document.getElementById('btc-input').value);
    if (price > 0) {
      this.btcPrice = price;
      this.calculate();
    }
  },

  async fetchBtc() {
    try {
      const res = await fetch('https://api.coingecko.com/api/v3/simple/price?ids=bitcoin&vs_currencies=usd');
      const data = await res.json();
      if (data.bitcoin?.usd) {
        this.btcPrice = data.bitcoin.usd;
        document.getElementById('btc-input').value = this.btcPrice;
        this.calculate();
      }
    } catch (e) {
      alert('Failed to fetch. Enter manually.');
    }
  },

  calculate() {
    const d = MACRO_DATA;

    // Net Liquidity
    const fedBs = d.fedBalanceSheet * 1e6;
    const tga = d.tga * 1e6;
    const rrp = d.rrp * 1e9;
    const netLiq = fedBs - tga - rrp;

    // YoY change
    const fedBsYoY = d.fedBalanceSheetYoY * 1e6;
    const netLiqYoY = ((fedBs - fedBsYoY) / fedBsYoY) * 100;

    // Financial Conditions Index (0-100, higher = looser)
    let fci = 50;
    fci += (110 - d.dxy) * 2.5;  // Dollar weakness
    fci += (5 - d.hySpread) * 6;  // Tight spreads
    fci += d.yieldCurve * 10;  // Steep curve
    fci = Math.max(0, Math.min(100, fci));

    // BTC Fair Value (liquidity-based)
    const baseLiq = 5.95e12;
    const baseBtc = 90000;
    const btcFairValue = baseBtc * Math.pow(netLiq / baseLiq, 1.4);
    const btcDiscount = ((btcFairValue - this.btcPrice) / btcFairValue) * 100;

    // ISM momentum
    const ismMomentum = d.ism - d.ism3moAgo;

    // Calculate scores
    const scores = [];

    // Net Liquidity YoY (20%)
    let liqScore = 0, liqSignal = 'Neutral';
    if (netLiqYoY > 5) { liqScore = 20; liqSignal = 'Bullish'; }
    else if (netLiqYoY > 0) { liqScore = 10; liqSignal = 'Neutral'; }
    else if (netLiqYoY > -5) { liqScore = 0; liqSignal = 'Caution'; }
    else { liqScore = -10; liqSignal = 'Bearish'; }
    scores.push({ name: 'Net Liquidity YoY', value: netLiqYoY.toFixed(1) + '%', signal: liqSignal, weight: 20, score: liqScore });

    // DXY (15%)
    let dxyScore = 0, dxySignal = 'Neutral';
    if (d.dxy < 105) { dxyScore = 15; dxySignal = 'Bullish'; }
    else if (d.dxy < 110) { dxyScore = 7; dxySignal = 'Neutral'; }
    else if (d.dxy < 115) { dxyScore = 0; dxySignal = 'Caution'; }
    else { dxyScore = -8; dxySignal = 'Bearish'; }
    scores.push({ name: 'Trade-Weighted Dollar', value: d.dxy.toFixed(1), signal: dxySignal, weight: 15, score: dxyScore });

    // HY Spread (10%)
    let hyScore = 0, hySignal = 'Neutral';
    if (d.hySpread < 4) { hyScore = 10; hySignal = 'Bullish'; }
    else if (d.hySpread < 5) { hyScore = 5; hySignal = 'Neutral'; }
    else if (d.hySpread < 6) { hyScore = 0; hySignal = 'Caution'; }
    else { hyScore = -5; hySignal = 'Bearish'; }
    scores.push({ name: 'HY Credit Spread', value: d.hySpread.toFixed(2) + '%', signal: hySignal, weight: 10, score: hyScore });

    // Yield Curve (10%)
    let curveScore = 0, curveSignal = 'Neutral';
    if (d.yieldCurve > 0.5) { curveScore = 10; curveSignal = 'Bullish'; }
    else if (d.yieldCurve > 0) { curveScore = 5; curveSignal = 'Neutral'; }
    else if (d.yieldCurve > -0.3) { curveScore = 0; curveSignal = 'Caution'; }
    else { curveScore = -5; curveSignal = 'Bearish'; }
    scores.push({ name: '10Y-2Y Yield Curve', value: d.yieldCurve.toFixed(2) + '%', signal: curveSignal, weight: 10, score: curveScore });

    // ISM (15%)
    let ismScore = 0, ismSignal = 'Neutral';
    if (d.ism > 52) { ismScore = 15; ismSignal = 'Bullish'; }
    else if (d.ism > 50) { ismScore = 7; ismSignal = 'Neutral'; }
    else if (d.ism > 48) { ismScore = 0; ismSignal = 'Caution'; }
    else { ismScore = -8; ismSignal = 'Bearish'; }
    scores.push({ name: 'ISM Manufacturing', value: d.ism.toFixed(1), signal: ismSignal, weight: 15, score: ismScore });

    // ISM Momentum (10%)
    let momScore = 0, momSignal = 'Neutral';
    if (ismMomentum > 1) { momScore = 10; momSignal = 'Bullish'; }
    else if (ismMomentum > 0) { momScore = 5; momSignal = 'Neutral'; }
    else if (ismMomentum > -1) { momScore = 0; momSignal = 'Caution'; }
    else { momScore = -5; momSignal = 'Bearish'; }
    scores.push({ name: 'ISM 3Mo Momentum', value: (ismMomentum > 0 ? '+' : '') + ismMomentum.toFixed(1), signal: momSignal, weight: 10, score: momScore });

    // BTC vs Fair Value (20%)
    let btcScore = 0, btcSignal = 'Neutral';
    if (btcDiscount > 20) { btcScore = 20; btcSignal = 'Bullish'; }
    else if (btcDiscount > 10) { btcScore = 15; btcSignal = 'Bullish'; }
    else if (btcDiscount > 0) { btcScore = 5; btcSignal = 'Neutral'; }
    else if (btcDiscount > -20) { btcScore = 0; btcSignal = 'Caution'; }
    else { btcScore = -10; btcSignal = 'Bearish'; }
    scores.push({ name: 'BTC vs Fair Value', value: (btcDiscount > 0 ? '+' : '') + btcDiscount.toFixed(1) + '%', signal: btcSignal, weight: 20, score: btcScore });

    // Total score
    const totalScore = scores.reduce((a, s) => a + s.score, 0);
    const maxScore = scores.reduce((a, s) => a + s.weight, 0);
    const cyclePos = 50 + (totalScore / maxScore) * 50;

    // Season
    let season, mainSignal;
    if (cyclePos >= 75) { season = 'SUMMER'; mainSignal = 'Risk On'; }
    else if (cyclePos >= 55) { season = 'SPRING'; mainSignal = 'Accumulate'; }
    else if (cyclePos >= 35) { season = 'FALL'; mainSignal = 'Reduce Risk'; }
    else { season = 'WINTER'; mainSignal = 'Defensive'; }

    // Update UI
    this.updateUI({
      netLiq, netLiqYoY, fci,
      btcFairValue, btcDiscount, ismMomentum,
      scores, cyclePos, season, mainSignal,
      liqSignal, btcSignal, ismSignal
    });
  },

  updateUI(data) {
    const fmt = (n) => '$' + (n / 1e12).toFixed(2) + 'T';
    const d = MACRO_DATA;

    // Header
    document.getElementById('cycle-score').textContent = data.cyclePos.toFixed(0);
    document.getElementById('cycle-season').textContent = data.season;
    document.getElementById('main-signal').textContent = data.mainSignal;
    document.getElementById('data-date').textContent = d.asOf;

    // Season colors
    const seasonColors = { 'SUMMER': 'text-green-400', 'SPRING': 'text-yellow-400', 'FALL': 'text-orange-400', 'WINTER': 'text-blue-400' };
    document.getElementById('cycle-season').className = 'text-lg font-semibold ' + (seasonColors[data.season] || 'text-gray-400');
    document.getElementById('cycle-score').className = 'text-2xl font-bold ' + (seasonColors[data.season] || 'text-gray-400');

    // Needle position
    document.getElementById('cycle-needle').style.left = data.cyclePos + '%';

    // Probability grid
    const bull = Math.max(0, (data.cyclePos - 50) * 2);
    const bear = Math.max(0, (50 - data.cyclePos) * 2);
    document.getElementById('prob-bullish').textContent = bull.toFixed(0) + '%';
    document.getElementById('prob-neutral').textContent = Math.max(0, 100 - bull - bear - 20).toFixed(0) + '%';
    document.getElementById('prob-caution').textContent = Math.min(30, Math.max(0, 40 - Math.abs(data.cyclePos - 50))).toFixed(0) + '%';
    document.getElementById('prob-bearish').textContent = bear.toFixed(0) + '%';

    // Data cards
    document.getElementById('net-liquidity').textContent = fmt(data.netLiq);
    document.getElementById('liq-yoy').textContent = (data.netLiqYoY > 0 ? '+' : '') + data.netLiqYoY.toFixed(1) + '%';
    document.getElementById('liq-signal').textContent = data.liqSignal;

    document.getElementById('fci-score').textContent = data.fci.toFixed(0);
    document.getElementById('fci-dxy').textContent = d.dxy.toFixed(1);
    document.getElementById('fci-hy').textContent = d.hySpread.toFixed(2) + '%';
    document.getElementById('fci-curve').textContent = d.yieldCurve.toFixed(2) + '%';

    document.getElementById('ism-value').textContent = d.ism.toFixed(1);
    document.getElementById('ism-momentum').textContent = (data.ismMomentum > 0 ? '+' : '') + data.ismMomentum.toFixed(1);
    document.getElementById('ism-signal').textContent = data.ismSignal;

    document.getElementById('btc-discount').textContent = (data.btcDiscount > 0 ? '+' : '') + data.btcDiscount.toFixed(1) + '%';
    document.getElementById('btc-fair-value').textContent = '$' + Math.round(data.btcFairValue).toLocaleString();
    document.getElementById('btc-signal').textContent = data.btcSignal;

    // Signal badge colors
    const signalColors = {
      'Bullish': 'bg-green-500/20 text-green-400',
      'Neutral': 'bg-yellow-500/20 text-yellow-400',
      'Caution': 'bg-orange-500/20 text-orange-400',
      'Bearish': 'bg-red-500/20 text-red-400'
    };
    document.getElementById('liq-signal').className = 'text-xs px-2 py-0.5 rounded ' + (signalColors[data.liqSignal] || '');
    document.getElementById('ism-signal').className = 'text-xs px-2 py-0.5 rounded ' + (signalColors[data.ismSignal] || '');
    document.getElementById('btc-signal').className = 'text-xs px-2 py-0.5 rounded ' + (signalColors[data.btcSignal] || '');

    // Scorecard table
    document.getElementById('scorecard-body').innerHTML = data.scores.map(s => {
      const signalClass = signalColors[s.signal]?.split(' ')[1] || 'text-gray-400';
      const scoreClass = s.score > 0 ? 'text-green-400' : s.score < 0 ? 'text-red-400' : 'text-gray-400';
      return `
        <tr class="border-b border-gray-800/50">
          <td class="py-2 text-gray-300">${s.name}</td>
          <td class="py-2 text-right text-gray-100 font-mono">${s.value}</td>
          <td class="py-2 text-right ${signalClass}">${s.signal}</td>
          <td class="py-2 text-right text-gray-500">${s.weight}%</td>
          <td class="py-2 text-right font-semibold ${scoreClass}">${s.score > 0 ? '+' : ''}${s.score}</td>
        </tr>
      `;
    }).join('');
  }
};

document.addEventListener('DOMContentLoaded', () => MacroApp.init());
</script>
